<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title>ë°”ì´ë¸” ìŠ¤í† ë¦¬ ìœ„ë²„ - ë‚˜ë§Œì˜ AI ì„±ê²½ ë™í™”</title>
    
    <!-- Tailwind CSS (ë””ìì¸ ë„êµ¬) -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- í°íŠ¸ (ê³ ìš´ë°”íƒ•, ë³¸ê³ ë”•) -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Gowun+Batang:wght@400;700&family=Noto+Sans+KR:wght@400;500;700&display=swap" rel="stylesheet">
    
    <style>
      body { font-family: 'Noto Sans KR', sans-serif; overscroll-behavior-y: none; }
      .font-story { font-family: 'Gowun Batang', serif; }
      @keyframes float {
        0% { transform: translateY(0px); }
        50% { transform: translateY(-5px); }
        100% { transform: translateY(0px); }
      }
      .animate-float { animation: float 3s ease-in-out infinite; }
    </style>

    <!-- êµ¬ê¸€ AI (Gemini) ë¶ˆëŸ¬ì˜¤ê¸° -->
    <script type="importmap">
      { "imports": { "@google/generative-ai": "https://esm.run/@google/generative-ai" } }
    </script>
</head>

<body class="bg-amber-50 text-stone-800 antialiased min-h-screen flex flex-col items-center justify-center p-4 selection:bg-amber-200">

    <!-- ë©”ì¸ ì»¨í…Œì´ë„ˆ -->
    <div class="w-full max-w-lg bg-white rounded-3xl shadow-xl overflow-hidden border border-amber-100">
        
        <!-- í—¤ë” ì˜ì—­ -->
        <div class="bg-amber-100 p-6 text-center relative overflow-hidden">
            <div class="absolute top-0 left-0 w-full h-full opacity-10 bg-[url('https://www.transparenttextures.com/patterns/cubes.png')]"></div>
            <h1 class="font-story text-3xl font-bold text-amber-800 mb-2 animate-float">ğŸ“– ë°”ì´ë¸” ìŠ¤í† ë¦¬ ìœ„ë²„</h1>
            <p class="text-amber-700 text-sm">AIê°€ ë“¤ë ¤ì£¼ëŠ” ë‚˜ë§Œì˜ ì„±ê²½ ì´ì•¼ê¸°</p>
        </div>

        <!-- ì…ë ¥ ì˜ì—­ -->
        <div class="p-8 space-y-6">
            <div class="space-y-2">
                <label class="block text-sm font-medium text-stone-600 ml-1">ë“£ê³  ì‹¶ì€ ì´ì•¼ê¸°ë¥¼ ì…ë ¥í•˜ì„¸ìš”</label>
                <input type="text" id="topicInput" 
                    class="w-full px-4 py-3 rounded-xl border-2 border-amber-200 focus:border-amber-400 focus:ring-4 focus:ring-amber-100 outline-none transition-all font-story text-lg placeholder-stone-400"
                    placeholder="ì˜ˆ: ë¬¼ ìœ„ë¥¼ ê±·ëŠ” ë² ë“œë¡œ, ìƒì–´ë²„ë¦° ì–‘">
            </div>

            <button onclick="generateStory()" id="generateBtn"
                class="w-full bg-amber-500 hover:bg-amber-600 text-white font-bold py-3.5 rounded-xl shadow-lg transform active:scale-95 transition-all flex items-center justify-center gap-2">
                <span>âœ¨ ë™í™” ë§Œë“¤ê¸°</span>
            </button>

            <!-- ë¡œë”© ë©”ì‹œì§€ -->
            <div id="loading" class="hidden text-center py-4">
                <div class="inline-block animate-spin rounded-full h-8 w-8 border-4 border-amber-200 border-t-amber-500 mb-2"></div>
                <p class="text-amber-600 font-story animate-pulse">AI ì‘ê°€ë‹˜ì´ ì´ì•¼ê¸°ë¥¼ ì§“ê³  ìˆì–´ìš”...</p>
            </div>
        </div>

        <!-- ê²°ê³¼ ì˜ì—­ -->
        <div id="resultArea" class="hidden bg-stone-50 p-6 border-t border-amber-100">
            <h2 id="storyTitle" class="font-story text-2xl font-bold text-amber-800 mb-4 text-center"></h2>
            <div id="storyContent" class="font-story text-lg leading-relaxed text-stone-700 whitespace-pre-line text-justify"></div>
            
            <button onclick="location.reload()" 
                class="mt-6 w-full bg-white border-2 border-amber-200 text-amber-600 py-2 rounded-lg hover:bg-amber-50 font-bold transition-colors">
                ğŸ”„ ë‹¤ë¥¸ ì´ì•¼ê¸° ë§Œë“¤ê¸°
            </button>
        </div>
    </div>

    <!-- í‘¸í„° -->
    <p class="mt-6 text-stone-400 text-xs text-center font-story">Created with Google Gemini API</p>

    <!-- ìë°”ìŠ¤í¬ë¦½íŠ¸ (ê¸°ëŠ¥ ë¶€ë¶„) -->
    <script type="module">
        import { GoogleGenerativeAI } from "@google/generative-ai";

        // ğŸ”´ğŸ”´ [ì¤‘ìš”] ì—¬ê¸°ì— ì•„ê¹Œ ë°›ì€ êµ¬ê¸€ í‚¤(AIza...)ë¥¼ ë„£ìœ¼ì„¸ìš”! ğŸ”´ğŸ”´
        const API_KEY = "AIzaSyAQIg1kKKW5UMaauyffc0j8CDXv6J51564"; 

        const genAI = new GoogleGenerativeAI(API_KEY);
        const model = genAI.getGenerativeModel({ model: "gemini-1.5-flash" });

        window.generateStory = async function() {
            const topic = document.getElementById('topicInput').value;
            const btn = document.getElementById('generateBtn');
            const loading = document.getElementById('loading');
            const resultArea = document.getElementById('resultArea');

            if (!topic) {
                alert("ì–´ë–¤ ì´ì•¼ê¸°ë¥¼ ë§Œë“¤ì§€ ì•Œë ¤ì£¼ì„¸ìš”! ğŸ˜Š");
                return;
            }

            // í™”ë©´ ìƒíƒœ ë³€ê²½ (ë¡œë”© ì¤‘)
            btn.disabled = true;
            btn.innerHTML = "â³ ì´ì•¼ê¸° ë§Œë“œëŠ” ì¤‘...";
            loading.classList.remove('hidden');
            resultArea.classList.add('hidden');

            try {
                const prompt = `
                ë„ˆëŠ” ì£¼ì¼í•™êµ ì„ ìƒë‹˜ì´ì•¼. ì•„ì´ë“¤ì„ ìœ„í•´ ì„±ê²½ ì´ì•¼ê¸°ë¥¼ ë™í™”ë¡œ ë§Œë“¤ì–´ì¤˜.
                ì£¼ì œ: '${topic}'
                
                [ì¡°ê±´]
                1. ì œëª©ì„ ë§¨ ìœ—ì¤„ì— ì¨ì¤˜. (ì˜ˆ: ğŸŒŠ ë¬¼ ìœ„ë¥¼ ê±¸ì€ ë² ë“œë¡œ)
                2. ë‚´ìš©ì€ ì•„ì´ë“¤ì´ ì´í•´í•˜ê¸° ì‰½ê²Œ ë¶€ë“œëŸ¬ìš´ ë§íˆ¬ë¡œ ì¨ì¤˜. (~í–ˆì–´ìš”, ~í–ˆë‹µë‹ˆë‹¤)
                3. ë‚´ìš© ì¤‘ê°„ì¤‘ê°„ì— ì–´ìš¸ë¦¬ëŠ” ì´ëª¨í‹°ì½˜ì„ ë„£ì–´ì¤˜.
                4. ë§ˆì§€ë§‰ì—ëŠ” ì§§ì€ êµí›ˆì„ í•œ ë¬¸ì¥ ë‚¨ê²¨ì¤˜.
                `;

                const result = await model.generateContent(prompt);
                const response = await result.response;
                const text = response.text();

                // ì œëª©ê³¼ ë³¸ë¬¸ ë‚˜ëˆ„ê¸°
                const lines = text.split('\n');
                let title = lines[0].replace(/#/g, '').replace(/\*\*/g, '');
                let content = lines.slice(1).join('\n').replace(/\*\*/g, ''); // ** ì œê±°

                // í™”ë©´ì— í‘œì‹œ
                document.getElementById('storyTitle').innerText = title;
                document.getElementById('storyContent').innerText = content;
                
                loading.classList.add('hidden');
                resultArea.classList.remove('hidden');

            } catch (error) {
                console.error(error);
                alert("ì˜¤ë¥˜ê°€ ë‚¬ì–´ìš”! API í‚¤ê°€ ì •í™•í•œì§€ í™•ì¸í•´ì£¼ì„¸ìš”.");
            } finally {
                btn.disabled = false;
                btn.innerHTML = "<span>âœ¨ ë™í™” ë§Œë“¤ê¸°</span>";
            }
        }
    </script>
</body>
</html>
